<div class="header">
  <!-- Logo + TiÃªu Ä‘á» -->
  <header style="display: flex; align-items: center; justify-content: center;">
    <img src="https://raw.githubusercontent.com/DoHoangTan/tdesign.ai.vn/main/logo.svg" alt="logo" loading="lazy" style="width:40px;height:40px;margin-right:10px;">
    <h2 id="titleText">âœ¨ Tdesign Daily Quote âœ¨</h2>
  </header>

  <!-- Google ÄÄƒng nháº­p -->
  <div id="g_id_onload"
       data-client_id="812902619403-7o2d3r3c8j855fhhhljkquqotdbdic68.apps.googleusercontent.com"
       data-callback="handleCredentialResponse"
       data-auto_prompt="false">
  </div>
  <div class="g_id_signin" data-type="standard"></div>

  <!-- Hiá»ƒn thá»‹ email -->
  <div id="user-email" style="margin-top: 10px; color: green; font-weight: bold;"></div>

  <!-- NgÃ´n ngá»¯ -->
  <div>
    <select onchange="changeLanguage(this.value)" id="languageSelector">
      <option value="vi">ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</option>
      <option value="en">ğŸ‡ºğŸ‡¸ English</option>
    </select>
  </div>

  <!-- Menu -->
  <div class="nav">
    <a href="index.html">Trang tá»•ng</a>
    <a href="ImageGenerator.html">GhÃ©p áº£nh</a>
    <a href="removebg.html">XÃ³a ná»n</a>
    <a href="qrcode.html">Táº¡o QR</a>
    <a href="about.html">LiÃªn há»‡</a>
  </div>
</div>

<!-- Script xá»­ lÃ½ Ä‘Äƒng nháº­p + ngÃ´n ngá»¯ -->
<script>
  const translations = {
    vi: {
      title: "âœ¨ Tdesign â€“ CÃ¢u truyá»n Ä‘á»™ng lá»±c âœ¨",
    },
    en: {
      title: "âœ¨ Tdesign â€“ Daily Motivation âœ¨",
    }
  };

  let currentLang = localStorage.getItem("lang") || "vi";
  document.getElementById("languageSelector").value = currentLang;

  function changeLanguage(lang) {
    currentLang = lang;
    localStorage.setItem("lang", lang);
    document.getElementById("titleText").innerText = translations[lang].title;
    // Reload náº¿u cáº§n Ä‘á»“ng bá»™ cáº£ ná»™i dung
    // location.reload();
  }

  changeLanguage(currentLang);

  function parseJwt(token) {
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const jsonPayload = decodeURIComponent(atob(base64).split('').map(c =>
      '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
    return JSON.parse(jsonPayload);
  }

  async function handleCredentialResponse(response) {
    const decoded = parseJwt(response.credential);
    const email = decoded.email || "";
    const name = decoded.name || "";

    document.getElementById("user-email").innerText = `âœ… ÄÄƒng nháº­p: ${name} (${email})`;

    const emailFileUrl = 'https://raw.githubusercontent.com/DoHoangTan/tdesign.ai.vn/main/dsEmail.txt';
    let allowedEmails = [];
    try {
      const res = await fetch(emailFileUrl);
      const text = await res.text();
      allowedEmails = text.split(',').map(e => e.trim());
    } catch (e) {
      console.error("KhÃ´ng thá»ƒ táº£i danh sÃ¡ch email.");
    }

    if (!allowedEmails.includes(email)) {
      document.body.innerHTML = "<h3 style='color:red;'>Báº¡n khÃ´ng cÃ³ quyá»n sá»­ dá»¥ng chá»©c nÄƒng nÃ y.</h3>";
    }
  }
</script>
