<script>
  async function fetchQuote() {
    try {
      const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQg_3_NR-NJ2LlFFcPqOitsapLFrs3x3UdIBBMKzcjRE5q78hlq_Z_bku7w_qx344TS0M-C7x2UtAP0/pub?output=csv";
      const res = await fetch(sheetUrl);
      const text = await res.text();
      const rows = text.split("\n").map(row => row.split(","));

      const today = new Date();
      const baseDate = new Date("2025-05-01");
      const diff = Math.floor((today - baseDate) / (1000 * 60 * 60 * 24));
      const rowIndex = Math.max(1, diff + 1); // +1 vì A1 là 01/05/2025

      const row = rows[rowIndex];
      if (row && row.length >= 3) {
        const quote = row[1];
        const imgUrl = row[2];
        document.getElementById("quote-text").innerText = quote;
        document.getElementById("quote-container").style.backgroundImage = `url('${imgUrl}')`;
      } else {
        document.getElementById("quote-text").innerText = "Không tìm thấy nội dung phù hợp.";
      }
    } catch (e) {
      document.getElementById("quote-text").innerText = "Lỗi tải dữ liệu.";
    }
  }

  function changeQuoteSize() {
    const size = document.getElementById("sizeSelector").value;
    const [width, height] = size.split("x");
    const container = document.getElementById("quote-container");
    container.style.width = width + "px";
    container.style.height = height + "px";
  }

  window.onload = fetchQuote;
</script>
